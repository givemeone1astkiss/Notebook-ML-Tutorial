# Sampling Methods

采样算法，或蒙特卡洛算法，是一类随机的近似推断方法，其解决的基本问题是关于一个概率分布 $p(z)$ 寻找某个函数 $f(z)$ 的期望：
$$
\mathbb E[f]=\int f(z)p(z)~\mathrm dz
$$
采样方法的基本思想是从概率分布 $p(z)$ 中独立抽取一组变量 $z^{(i)}$，其中 $l=1,2\dotsb,L$，这使得期望可以通过有线求和的方式估计：
$$
\hat f=\frac1L\sum_{i=1}^L f(z^{(i)})
$$
只要样本是从概率分布  $p(z)$ 中抽取的，那么 $\mathbb E[\hat f]=\mathbb E[f]$，因此估计 $\hat f$ 具有正确的均值，估计样本的方差为：
$$
\mathrm{Var}[\hat f]=\frac1L\mathbb E[(f-\mathbb E[f])^2]
$$
但是问题在于样本 $\{z^{(i)}\}$ 可能并并不独立，因此有效样本数量会远小于表观的样本数量，并且如果 $f(z)$ 在 $p(z)$ 较大的区域的值较小，或者在 $p(z)$ 较小的区域取值较大，那么期望可能由小概率的区域控制，为了达到足够的精度，需要较大的样本大小。

对于许多模型，联合概率分布可以由图模型确定，在没有观测变量的情况下，从联合概率分布 $p(z)=\prod_{i=1}^Mp(z_i\mid\mathrm {pa_i})$ 中采样是容易的，可以使用祖先采样方法，按照 $z_1,z_2,\dotsb,z_M$ 的顺序遍历一遍变量集合，对图遍历一次之后，我么们会得到来自联合概率的一个样本。

对于部分节点被观测值初始化的有向图的情况，我们可以对上面的采样方法进行推广，在每一个步骤中，我们得到变量 $z_i$ 的一个采样值，它的值被观测，并且将采样值与观测值相比较，如果它们相符，那么采样值被保留，算法继续进行，处理下一个变量，否则从第一个节点重新初始化采样。

对于由无向图定义的概率分布，不存在从没有观测变量的先验概率中一遍采样的方法。

## 1 Basic Sampling Methods
### 1.1 Standard Distributions

假设我们有一个均匀分布的随机数来源 $z\sim\mathrm{Norm}(0,1)$，我们使用某个函数 $f(\sdot)$ 对 $z$ 的值进行变换 $y=f(z)$，则有：
$$
p(y)=p(z)\left|\frac{\mathrm d z}{\mathrm d y}\right|
$$
